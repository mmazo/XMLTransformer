function XMLTransformer(){var t=this;this.data=null;this.template=null;this.render=function(xmlUrl,xslUrl,targetId){loadXMLDoc({succFunc:function(con){t.data=con;loadXMLDoc({succFunc:function(con){t.template=con;transformXML(targetId);},url:xslUrl});},url:xmlUrl});};function loadXMLDoc(params){jQuery.ajax({type:"GET",dataType:"xml",url:params.url,success:function(msg){if(params.succFunc){params.succFunc(msg);}},error:function(msg){if(params.errorFunc){params.errorFunc(msg);}}});}
function transformXML(trgId){if(window.ActiveXObject){var ex=t.data.transformNode(t.template);document.getElementById(trgId).innerHTML=ex;}
else if(document.implementation&&document.implementation.createDocument){var xsltProcessor=new XSLTProcessor();xsltProcessor.importStylesheet(t.template);resultDocument=xsltProcessor.transformToFragment(t.data,document);document.getElementById(trgId).appendChild(resultDocument);}}}